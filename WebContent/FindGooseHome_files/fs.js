try{"undefined"===typeof WeakMap&&function(){var g=Object.defineProperty,z=Date.now()%1E9,a=function(){this.name="__st"+(1E9*Math.random()>>>0)+(z++ +"__")};a.prototype={set:function(a,f){var d=a[this.name];d&&d[0]===a?d[1]=f:g(a,this.name,{value:[a,f],writable:!0})},get:function(a){var f;return(f=a[this.name])&&f[0]===a?f[1]:void 0}};window.WeakMap=a}()}catch(e$$12){};try{(function(g){function z(){q=!1;var b=r;r=[];b.sort(function(a,b){return a.uid_-b.uid_});var h=!1;b.forEach(function(b){var k=b.takeRecords();a(b);k.length&&(b.callback_(k,b),h=!0)});h&&z()}function a(a){a.nodes_.forEach(function(b){(b=h.get(b))&&b.forEach(function(b){b.observer===a&&b.removeTransientObservers()})})}function c(a,b){for(var k=a;k;k=k.parentNode){var e=h.get(k);if(e)for(var m=0;m<e.length;m++){var d=e[m],p=d.options;(k===a||p.subtree)&&(p=b(p))&&d.enqueue(p)}}}function f(a){this.callback_=
a;this.nodes_=[];this.records_=[];this.uid_=++s}function d(a,b){this.type=a;this.target=b;this.addedNodes=[];this.removedNodes=[];this.oldValue=this.attributeNamespace=this.attributeName=this.nextSibling=this.previousSibling=null}function e(a,b){return t=new d(a,b)}function b(a){if(u)return u;var b=t,k=new d(b.type,b.target);k.addedNodes=b.addedNodes.slice();k.removedNodes=b.removedNodes.slice();k.previousSibling=b.previousSibling;k.nextSibling=b.nextSibling;k.attributeName=b.attributeName;k.attributeNamespace=
b.attributeNamespace;k.oldValue=b.oldValue;u=k;u.oldValue=a;return u}function k(a,b,k){this.observer=a;this.target=b;this.options=k;this.transientObservedNodes=[]}var h=new WeakMap,m=window.msSetImmediate;if(!m){var p=[],l=String(Math.random());window.addEventListener("message",function(a){a.data===l&&(a=p,p=[],a.forEach(function(a){a()}))});m=function(a){p.push(a);window.postMessage(l,"*")}}var q=!1,r=[],s=0;f.prototype={observe:function(a,b){a=window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(a)||
a;if(!b.childList&&!b.attributes&&!b.characterData||b.attributeOldValue&&!b.attributes||b.attributeFilter&&b.attributeFilter.length&&!b.attributes||b.characterDataOldValue&&!b.characterData)throw new SyntaxError;var e=h.get(a);e||h.set(a,e=[]);for(var m,d=0;d<e.length;d++)if(e[d].observer===this){m=e[d];m.removeListeners();m.options=b;break}m||(m=new k(this,a,b),e.push(m),this.nodes_.push(a));m.addListeners()},disconnect:function(){this.nodes_.forEach(function(a){a=h.get(a);for(var b=0;b<a.length;b++){var k=
a[b];if(k.observer===this){k.removeListeners();a.splice(b,1);break}}},this);this.records_=[]},takeRecords:function(){var a=this.records_;this.records_=[];return a}};var t,u;k.prototype={enqueue:function(a){var b=this.observer.records_,k=b.length;if(0<b.length){var h=b[k-1];h=h===a?h:!u||h!==u&&h!==t?null:u;if(h){b[k-1]=h;return}}else r.push(this.observer),q||(q=!0,m(z));b[k]=a},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(a){var b=this.options;b.attributes&&a.addEventListener("DOMAttrModified",
this,!0);b.characterData&&a.addEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.addEventListener("DOMNodeInserted",this,!0);(b.childList||b.subtree)&&a.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(a){var b=this.options;b.attributes&&a.removeEventListener("DOMAttrModified",this,!0);b.characterData&&a.removeEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.removeEventListener("DOMNodeInserted",
this,!0);(b.childList||b.subtree)&&a.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(a){if(a!==this.target){this.addListeners_(a);this.transientObservedNodes.push(a);var b=h.get(a);b||h.set(a,b=[]);b.push(this)}},removeTransientObservers:function(){var a=this.transientObservedNodes;this.transientObservedNodes=[];a.forEach(function(a){this.removeListeners_(a);a=h.get(a);for(var b=0;b<a.length;b++)if(a[b]===this){a.splice(b,1);break}},this)},handleEvent:function(a){switch(a.type){case "DOMAttrModified":var k=
a.attrName,h=a.relatedNode.namespaceURI,m=a.target,d=new e("attributes",m);d.attributeName=k;d.attributeNamespace=h;var p=a.attrChange===MutationEvent.ADDITION?null:a.prevValue;c(m,function(a){if(a.attributes&&(!a.attributeFilter||!a.attributeFilter.length||-1!==a.attributeFilter.indexOf(k)||-1!==a.attributeFilter.indexOf(h)))return a.attributeOldValue?b(p):d});break;case "DOMCharacterDataModified":m=a.target;d=e("characterData",m);p=a.prevValue;c(m,function(a){if(a.characterData)return a.characterDataOldValue?
b(p):d});break;case "DOMNodeRemoved":this.addTransientObserver(a.target);case "DOMNodeInserted":var m=a.relatedNode,l=a.target,q;"DOMNodeInserted"===a.type?(a=[l],q=[]):(a=[],q=[l]);var f=l.previousSibling,l=l.nextSibling,d=e("childList",m);d.addedNodes=a;d.removedNodes=q;d.previousSibling=f;d.nextSibling=l;c(m,function(a){if(a.childList)return d})}t=u=void 0}};g.JsMutationObserver=f;!g.MutationObserver&&g.WebKitMutationObserver&&(g.MutationObserver=g.WebKitMutationObserver);g.MutationObserver||(g.MutationObserver=
f)})(this)}catch(e$$15){};var _fs_git_hash="198c72d898632b45426493e6161c2ff745159853";
(function(){var g;(function(a){a.EVENT_MUT_INSERT=2;a.EVENT_MUT_REMOVE=3;a.EVENT_MUT_ATTR=4;a.EVENT_MUT_ATTR_CURVE=5;a.EVENT_MUT_TEXT=6;a.EVENT_MUT_SKIPIDS=7;a.EVENT_MOUSEMOVE=8;a.EVENT_MOUSEMOVE_CURVE=9;a.EVENT_SCROLL=10;a.EVENT_SCROLL_CURVE=11;a.EVENT_MOUSEDOWN=12;a.EVENT_MOUSEUP=13;a.EVENT_KEYDOWN=14;a.EVENT_KEYUP=15;a.EVENT_CLICK=16;a.EVENT_FOCUS=17;a.EVENT_VALUECHANGE=18;a.EVENT_RESIZE=19;a.EVENT_DOMLOADED=20;a.EVENT_LOAD=21;a.EVENT_PLACEHOLDER_SIZE=22;a.EVENT_UNLOAD=23;a.EVENT_BLUR=24;a.EVENT_SET_FRAME_BASE=
25;a.EVENT_TOUCHSTART=32;a.EVENT_TOUCHEND=33;a.EVENT_TOUCHCANCEL=34;a.EVENT_TOUCHMOVE=35;a.EVENT_TOUCHMOVE_CURVE=36;a.EVENT_NAVIGATE=37;a.EVENT_PLAY=38;a.EVENT_PAUSE=39;a.EVENT_INNERWIDTH=40;a.EVENT_INNERWIDTH_CURVE=41;a.EVENT_LOG=48;a.EVENT_ERROR=49;a.EVENT_DBL_CLICK=50;a.EVENT_FORM_SUBMIT=51;a.EVENT_SYS_SETMETA=8192;a.EVENT_SYS_SETVAR=8193;a.EVENT_COOKED_LOAD="load";a.EVENT_COOKED_UNLOAD="unload";a.EVENT_COOKED_NAVIGATE="navigate";a.EVENT_COOKED_CLICK="click";a.EVENT_COOKED_FOCUS="focus";a.EVENT_COOKED_CHANGE=
"change";a.EVENT_COOKED_MOUSE_THRASH="thrash";a.isUserActionEvent=function(c){switch(c){case a.EVENT_MOUSEDOWN:case a.EVENT_MOUSEMOVE:case a.EVENT_MOUSEMOVE_CURVE:case a.EVENT_MOUSEUP:case a.EVENT_KEYDOWN:case a.EVENT_KEYUP:case a.EVENT_TOUCHSTART:case a.EVENT_TOUCHEND:case a.EVENT_TOUCHMOVE:case a.EVENT_TOUCHMOVE_CURVE:case a.EVENT_TOUCHCANCEL:case a.EVENT_CLICK:case a.EVENT_SCROLL:case a.EVENT_SCROLL_CURVE:case a.EVENT_NAVIGATE:return!0}return!1};a.MAX_LOGS_PER_PAGE=1024})(g||(g={}));(function(a){function c(a){var k=
{};if(!a)return k;if(a.classList)for(var h=0;h<a.classList.length;++h)k[a.classList[h]]=!0;else if(a.className)for(a=(null!=a.className.animVal?a.className.animVal:a.className).split(" "),h=0;h<a.length;++h)k[a[h].trim()]=!0;return k}a.NYI_KIND="nyi";a.BLOCKED_KIND="blocked";a.HIDE_KIND="hide";var f=function(){function a(b,h){var m=this;this._parent=b;this._classes={};this._attrs={};for(var e=0,d=0,c=0,f=function(){if(0!=c-d)switch(e){case 0:m._tag=h.slice(d,c);break;case 1:m._id=h.slice(d+1,c);break;
case 2:m._classes[h.slice(d+1,c)]=!0;break;case 3:var a=h.slice(d,c).slice(1).split("="),b=a[0].trim(),a=a[1].trim();if("]"!=a[a.length-1])throw"Unsupported selector";a=a.slice(0,a.length-1);if("'"==a[0]||'"'==a[0]){if(a[a.length-1]!=a[0])throw"Unsupported selector";a=a.slice(1,a.length-1)}m._attrs[b]=a}},c=0;c<h.length;++c)switch(h[c]){case "#":f();e=1;d=c;break;case ".":f();e=2;d=c;break;case "[":f(),e=3,d=c}f()}a.prototype.parent=function(){return this._parent};a.prototype.serialize=function(){var a=
"";this._tag&&(a+=this._tag);this._id&&(a+="#"+this._id);for(var b in this._classes)a+="."+b;for(var m in this._attrs)a+="["+m+"="+this._attrs[m]+"]";return a};a.prototype.matches=function(a,b){if(!a||this._tag&&a.tagName.toLowerCase()!=this._tag||this._id&&a.id!=this._id)return!1;for(var m in this._classes)if(!(m in b))return!1;for(var e in this._attrs)if(a.getAttribute(e)!=this._attrs[e])return!1;return this._parent?this._parent.matches(a.parentElement,c(a.parentElement)):!0};return a}();a.BlockRuleElem=
f;var d=function(){function a(b){this.kind=b.Kind;b=b.Selector.split(">");for(var h=null,e=0;e<b.length;)var d=b[e++].trim(),h=new f(h,d);this.rules=h}a.prototype.serialize=function(){for(var a=null,b=this.rules;b;b=b.parent())a=a?b.serialize()+">"+a:b.serialize();return a};return a}();a.BlockRule=d;var e=function(){function a(){this._rules=[];this.rawRules=[]}a.prototype.isBlocked=function(a){for(var b=c(a),e=0;e<this._rules.length;++e)if(this._rules[e].rules.matches(a,b))return this._rules[e].kind;
return null};a.prototype.addRule=function(a){this.rawRules.push(a);this._rules.push(new d(a))};a.prototype.mungeBlockedStyle=function(a,b){var e=a.getBoundingClientRect(),d=Math.floor(e.width),e=Math.floor(e.height);if("object"==a.tagName.toLowerCase())for(var c=a.children,f=0;f<c.length;f++){var r=c[f];if("embed"==r.tagName.toLowerCase()){c=r.getBoundingClientRect();d=Math.max(d,Math.floor(c.width));e=Math.max(e,Math.floor(c.height));break}}c="";null!=b&&(c=b.trim());0<c.length&&";"!=c.charAt(c.length-
1)&&(c+=";");f=a.style.getPropertyValue("display");"inline"==(f?f:window.getComputedStyle(a).getPropertyValue("display")).toLowerCase()&&(c+="display: inline-block !important;");if(0!=d||0!=e)c+="width:"+d+"px;height:"+e+"px;";return c};return a}();a.Blocker=e})(g||(g={}));(function(a){a.Node_ELEMENT_NODE=1;a.Node_ATTRIBUTE_NODE=2;a.Node_TEXT_NODE=3;a.Node_CDATA_SECTION_NODE=4;a.Node_ENTITY_REFERENCE_NODE=5;a.Node_ENTITY_NODE=6;a.Node_PROCESSING_INSTRUCTION_NODE=7;a.Node_COMMENT_NODE=8;a.Node_DOCUMENT_NODE=
9;a.Node_DOCUMENT_TYPE_NODE=10;a.Node_DOCUMENT_FRAGMENT_NODE=11;a.Node_NOTATION_NODE=12;a.XHR_UNSENT=0;a.XHR_OPENED=1;a.XHR_HEADERS_RECEIVED=2;a.XHR_LOADING=3;a.XHR_DONE=4})(g||(g={}));(function(a){function c(a){return"_fsblocked"in a}function f(a,b){a._fsblocked=b}function d(a){return a?a._fs:null}function e(a){return(a=d(a))?a.id:0}function b(a,b){if(a.attributes&&0<a.attributes.length)for(var e=0;e<a.attributes.length;e++){var d=a.attributes[e];b(d.name,d.value)}}a.isBlocked=c;a.blockKind=function(a){return a._fsblocked};
a.setBlocked=f;a.mirrorFor=d;a.fsid=e;a.fsidIfNotBlocked=function(a){return c(a)?0:e(a)};var k=function(){function e(a,b){this._ctx=a;this._blocker=b;this._curId=1}e.prototype.curId=function(){return this._curId};e.prototype.tokenizeNode=function(a,b,e,k){var h=this._curId;try{var c=[],f=this.tokeNode(e,c,k);if(f&&a){var g=d(a),A=d(b);f.parent=g;A==g.child&&(g.child=f);f.next=A;null==A?(f.prev=g.lastChild,g.lastChild=f):f.prev=A.prev;null!=f.prev&&(f.prev.next=f);null!=f.next&&(f.next.prev=f)}return c}catch(B){return this._curId=
h,[]}};e.prototype.removeMirror=function(a){a.parent.child==a&&(a.parent.child=a.next);a.parent.lastChild==a&&(a.parent.lastChild=a.prev);a.prev&&(a.prev.next=a.next);a.next&&(a.next.prev=a.prev);a.id=0;a.child&&this.clearIds(a.child)};e.prototype.clearIds=function(a){a.id=0;a.next&&this.clearIds(a.next);a.child&&this.clearIds(a.child)};e.prototype.tokeNode=function(e,d,k){if("SCRIPT"==e.nodeName||e.nodeType==a.Node_COMMENT_NODE)return null;var h={id:this._curId++,node:e};e._fs=h;var c=e.nodeName;
"http://www.w3.org/2000/svg"==e.namespaceURI&&(c="svg:"+c);d.push("<"+c);try{if(this.processBlockedElem(e,d))return h;k&&k(e);b(e,function(a,b){d.push(":"+a);d.push(b)});if(e.firstChild){d.push("[");for(var c=null,f=e.firstChild;f;f=f.nextSibling){var g=this.tokeNode(f,d,k);g&&(g.parent=h,c?(c.next=g,g.prev=c):h.child=g,c=h.lastChild=g)}d.push("]")}e.nodeType==a.Node_TEXT_NODE&&d.push(e.textContent)}catch(u){}return h};e.prototype.processBlockedElem=function(e,d){var k=this;if(e.nodeType==a.Node_ELEMENT_NODE&&
this._blocker){var h=this._blocker.isBlocked(e);if(h){f(e,h);var c,g=!1;b(e,function(a,b){if("class"==a)b+=" _fs_block_"+h,c=!0;else if("style"==a)b=k._blocker.mungeBlockedStyle(e,b),g=!0;else if("value"==a||"checked"==a||"src"==a)return;d.push(":"+a);d.push(b)});c||(d.push(":class"),d.push("_fs_block_"+h));g||(d.push(":style"),d.push(this._blocker.mungeBlockedStyle(e,"")));return!0}}return!1};return e}();a.NodeEncoder=k})(g||(g={}));(function(a){function c(a,e){var d=Object.getOwnPropertyDescriptor(a.prototype,
e);Object.defineProperty(a.prototype,e,{set:function(a){var e=this;setTimeout(function(){b(e)},0);return d.set.call(this,a)},get:function(){return d.get.call(this)}})}function f(a){switch(a.type){case "checkbox":case "radio":return""+a.checked;default:return a.value}}var d=function(){function d(e,k){var c=this;this._onchange=e;this._checkElem=k;this._fallback=!1;this._elems={};this._values={};b=function(b){var e=a.fsid(b);if(e&&(b=c._elems[e])){var d=f(b);d!=c._values[e]&&(c._onchange(b),c._values[e]=
d)}}}d.prototype.hookEvents=function(){var a;(a=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"))&&a.set?(e||(c(HTMLInputElement,"value"),c(HTMLInputElement,"checked"),c(HTMLSelectElement,"value"),c(HTMLTextAreaElement,"value"),e=!0),a=!0):a=!1;a||(this._fallback=!0)};d.prototype.addInput=function(b){var e=a.fsid(b);this._elems[e]=b;this._values[e]=f(b);this._values[e]&&this._onchange(b)};d.prototype.tick=function(){if(this._fallback)for(var a in this._elems)if(this._checkElem(this._elems[a])){var b=
this._elems[a],e=f(b);e!=this._values[a]&&(this._onchange(b),this._values[a]=e)}else delete this._elems[a],delete this._values[a]};d.prototype._usingFallback=function(){return this._fallback};d.prototype._trackingElem=function(a){return!!this._elems[a]};return d}();a.InputWatcher=d;var e=!1,b;a.valueOfInputishElem=f})(g||(g={}));(function(a){var c=function(){function a(){this.dict={idx:-1,map:{}};this.startIdx=0}a.prototype.encode=function(a){function e(){k?1<p.length?c.push([k.idx,p.length]):c.push(k.idx):
c.push(p[0])}if(0==a.length)return[];var b,k=null,c=[],f,p=[a[0]];for(b=1;b<a.length;b++)if(f=a[b],k&&k.map.hasOwnProperty(f))p.push(f),k=k.map[f];else{e();var g=this.startIdx+b-p.length;null==k&&(k={idx:g,map:{}},this.dict.map[p[p.length-1]]=k);k.map[f]={idx:g,map:{}};p=[f];k=this.dict.map.hasOwnProperty(f)?this.dict.map[f]:null}e();this.startIdx+=a.length;return c};return a}();a.LZJGWEncoder=c;c=function(){function a(){this._seq=[]}a.prototype.sequence=function(){return this._seq};a.prototype.decode=
function(a){for(var e=this._seq.length,b=0;b<a.length;++b){var k=a[b];switch(typeof k){case "string":this._seq.push(k);break;case "number":this._seq.push(this._seq[k]);break;case "object":for(var c=0;c<k[1];c++)this._seq.push(this._seq[k[0]+c])}}return e};return a}();a.LZJGWDecoder=c})(g||(g={}));(function(a){a.MUTATION_PROCESSING_INTERVAL=250;a.CURVE_SAMPLING_INTERVAL=142;a.UPLOAD_INTERVAL=5E3;a.USER_INACTIVITY_TIMEOUT=1E4;var c=function(){function a(e){this._interval=e;this._handle=-1}a.prototype.oneShot=
function(a){setTimeout(a,this._interval)};a.prototype.start=function(a){-1==this._handle&&(this._handle=setInterval(a,this._interval))};a.prototype.stop=function(){-1!=this._handle&&(clearInterval(this._handle),this._handle=-1)};return a}(),f=function(){function d(e,b,d,h,f,g,l){void 0===h&&(h=function(){});void 0===f&&(f=new c(a.CURVE_SAMPLING_INTERVAL));void 0===g&&(g=new c(a.MUTATION_PROCESSING_INTERVAL));void 0===l&&(l=new c(a.UPLOAD_INTERVAL));this._ctx=e;this._processor=b;this._mutProvider=
d;this._beforeProcessEvents=h;this._sampleCurvesTicker=f;this._processMutationsTicker=g;this._uploadTicker=l;this._eventQueue=[];this._outgoingEventQueue=[];this._bundleQueue=[];this._recordingDisabled=!1;this._bundleSeq=1;this._lastWhenTime=this._lastPostTime=0;this._lastWhen=-1;this._lastUserAction=0;this._gotUnload=!1;this._lastBundleTime=e.wallTime()}d.prototype.rawQueue=function(){return this._eventQueue};d.prototype.startPipeline=function(){var a=this;this._recordingDisabled||this._pipelineStarted||
(this._lastUserAction=this._ctx.now(),this.processEvents(),this._processMutationsTicker.start(function(){a.processEvents()}),this._sampleCurvesTicker.start(function(){a.processEvents(!0)}),this._ctx.amInsideIFrame()||(this.enqueueAndSendBundle(),this._uploadTicker.start(function(){a.enqueueAndSendBundle()})),this._pipelineStarted=!0)};d.prototype.enqueue=function(a,b){this.enqueueAt(this._ctx.now(),a,b)};d.prototype.enqueueAt=function(e,b,d){this._recordingDisabled||(e<=this._lastWhen&&(e=this._lastWhen+
1),this._lastWhen=e,this._eventQueue.push({When:e,Kind:b,Args:d}),a.isUserActionEvent(b)&&(this._lastUserAction=e))};d.prototype.disableRecording=function(){this._recordingDisabled=!0;this.stopPipeline()};d.prototype.addUnload=function(){this._gotUnload||(this._gotUnload=!0,this.enqueue(a.EVENT_UNLOAD,[]),this.swanSong())};d.prototype.shutdown=function(){this._flush();this.addUnload();this._flush();this.disableRecording()};d.prototype._flush=function(){this.processEvents();this.maybeSendNextBundle()};
d.prototype.prequeue=function(a,b){this._recordingDisabled||this._eventQueue.unshift({When:0,Kind:a,Args:b})};d.prototype.appendToOutgoingQueue=function(a){this._outgoingEventQueue=this._outgoingEventQueue.concat(a)};d.prototype.appendToQueue=function(a){this._eventQueue=this._eventQueue.concat(a)};d.prototype.lastSentEventTime=function(){return this._lastWhenTime};d.prototype.swanSong=function(){if(!this._recordingDisabled&&!this._ctx.amInsideIFrame()&&(this.processEvents(),0<this._outgoingEventQueue.length&&
this.enqueueNextBundle(),0<this._bundleQueue.length||this._pendingBundle)){var e=this._bundleQueue.concat();this._pendingBundle&&e.unshift(this._pendingBundle);a.log("Saving "+e.length+" bundles in swan-song.");e={UserId:this._ctx.userId(),SessionId:this._ctx.sessionId(),PageId:this._ctx.pageId(),Bundles:e,Eventstore:this._ctx.eventstore(),PageStartTime:this._ctx.startTime(),LastBundleTime:this._lastBundleTime};try{localStorage.swanSong=a.stringify(e)}catch(b){}}};d.prototype.recoverSwanSong=function(){if(!this._ctx.amInsideIFrame())try{if("swanSong"in
localStorage){var e=localStorage.swanSong;delete localStorage.swanSong;var b=a.parseJson(e);if(b.Bundles)if(b.Bundles&&b.UserId&&b.SessionId&&b.PageId)for(e=0;e<b.Bundles.length;++e){var d=null;0==e&&(d=this._ctx.wallTime()-b.LastBundleTime);this.sendSwanSongBundle(b.UserId,b.SessionId,b.PageId,b.PageStartTime,b.Bundles[e],b.Eventstore,d)}else a.log("Malformed swan song found. Ignoring it.");else b.Bundle&&b.UserId&&b.SessionId&&b.PageId?this.sendSwanSongBundle(b.UserId,b.SessionId,b.PageId,b.PageStartTime||
0,b.Bundle,"cassandra",b.LastBundleTime?this._ctx.wallTime()-b.LastBundleTime:null):a.log("Malformed swan song found. Ignoring it.")}}catch(c){a.log("Error recovering swan-song: "+c)}};d.prototype.sendSwanSongBundle=function(e,b,d,c,f,g,l){e=this.bundleUrl(this._ctx.orgId(),e,b,d,f,g,c,l);this._ctx.post(e,f,function(b){a.log("Sent "+f.Evts.length+" trailing events from last session as Seq "+f.Seq)},function(){a.log("Failed to send events from last session")})};d.prototype.rebaseIframe=function(e,
b){var d=this._ctx.baseUri();0<this._eventQueue.length?this._eventQueue.unshift({When:this._eventQueue[0].When,Kind:a.EVENT_SET_FRAME_BASE,Args:[d,b]}):this.enqueue(a.EVENT_SET_FRAME_BASE,[d,b]);for(var d=0,c=this._eventQueue.length;d<c;d++){var f=this._eventQueue[d],g=f.When+this._ctx.startTime()-e;0>g&&(g=0);f.When=g}};d.prototype.processEvents=function(e){this._beforeProcessEvents();if((this._eventQueue.length||this._mutProvider.hasMutations())&&!(this._ctx.now()-this._lastUserAction>a.USER_INACTIVITY_TIMEOUT)&&
null!=this._ctx.frameId()){var b=this._eventQueue;this._eventQueue=[];b=this._processor.processQueue(b);e||(b=b.concat(this._mutProvider.processMutations()));this.ensureFrameIds(b);this._ctx.amInsideIFrame()?parent.postMessage(a.FS_IFRAME_EVENTS+a.FS_DELIMITER+a.stringify(b),"*"):void 0!==this._ctx.pageId()&&(this._outgoingEventQueue=this._outgoingEventQueue.concat(b))}};d.prototype.ensureFrameIds=function(a){var b=this._ctx.frameId();if(b)for(var d=this._ctx.parentIds(),c=d&&0<d.length,f=0;f<a.length;++f){var g=
a[f];g.FId||(g.FId=b);c&&!g.PIds&&(g.PIds=d)}};d.prototype.enqueueAndSendBundle=function(){this._pendingBundle?this._pendingBundleFailed&&this._sendPendingBundle():0==this._outgoingEventQueue.length?this.maybeSendNextBundle():this.enqueueNextBundle()};d.prototype.enqueueNextBundle=function(){var a={When:this._outgoingEventQueue[0].When,Seq:this._bundleSeq++,Evts:this._outgoingEventQueue};this._outgoingEventQueue=[];this._bundleQueue.push(a);this.maybeSendNextBundle()};d.prototype.maybeSendNextBundle=
function(){this._ctx.pageId()&&(!this._pendingBundle&&0!=this._bundleQueue.length)&&(this._pendingBundle=this._bundleQueue.shift(),this._sendPendingBundle())};d.prototype.bundleUrl=function(a,b,d,c,f,g,l,q){a="/rec/bundle?OrgId="+a+"&UserId="+b+"&SessionId="+d+"&PageId="+c+"&Seq="+f.Seq+"&Eventstore="+g;l&&(a+="&PageStartTime="+l);q&&(a+="&DeltaT="+q);return a};d.prototype._sendPendingBundle=function(){var e=this,b=this._pendingBundle;this._pendingBundleFailed=!1;var d=this._ctx.wallTime(),c=this.bundleUrl(this._ctx.orgId(),
this._ctx.userId(),this._ctx.sessionId(),this._ctx.pageId(),b,this._ctx.eventstore());this._lastPostTime=this._lastBundleTime=d;this._lastWhenTime=b.Evts[b.Evts.length-1].When;this._ctx.post(c,b,function(d){a.log("Sent bundle "+b.Seq+" with "+b.Evts.length+" events");e._pendingBundle=null;e._ctx.wallTime()-e._lastPostTime>a.UPLOAD_INTERVAL&&e.maybeSendNextBundle()},function(b){a.log("Failed to send events.");e._pendingBundleFailed=!0;404==b&&e._uploadTicker.stop()})};d.prototype.stopPipeline=function(){this._pipelineStarted&&
(this._sampleCurvesTicker.stop(),this._processMutationsTicker.stop(),this._uploadTicker.stop())};return d}();a.EventQueue=f})(g||(g={}));(function(a){var c=function(){function c(d,e,b){void 0===b&&(b=function(a,b){});this._ctx=d;this._blocker=e;this._visitor=b;this._sentDomSnapshot=!1;this._records=[];this._lz=new a.LZJGWEncoder;this._encoder=new a.NodeEncoder(d,e)}c.prototype.hasMutations=function(){return!this._sentDomSnapshot||0<this._records.length};c.prototype.hookMutations=function(a){var e=
this;void 0===a&&(a=document.documentElement);this._root=a;this._sentDomSnapshot=!1;(new window.MutationObserver(function(a){e._records=e._records.concat(a)})).observe(a,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})};c.prototype.processMutations=function(){var d=this._ctx.now(),e=[];this._sentDomSnapshot||(this.genInsert(d,e,null,this._root,null),this._sentDomSnapshot=!0);if(0==this._records.length)return e;var b={},c={};this.processRecords(d,
e,c,b);for(var h in c){var f=h.split(":");e.push({Kind:a.EVENT_MUT_ATTR,When:d,Args:[parseInt(f[0]),f[1],c[h]]})}for(h in b)e.push({Kind:a.EVENT_MUT_TEXT,When:d,Args:[parseInt(h),b[h]]});this._records=[];return e};c.prototype.processRecords=function(d,e,b,c){for(var f={},g={},p=0;p<this._records.length;++p)try{var l=this._records[p],q=a.fsid(l.target);if(q)switch(f[q]=l.target,l.type){case "childList":if(0<l.removedNodes.length)for(var r=0;r<l.removedNodes.length;++r){var s=a.mirrorFor(l.removedNodes[r]);
s&&s.id&&s.parent==a.mirrorFor(l.target)&&s.next==a.mirrorFor(l.nextSibling)&&this.genRemove(d,e,s)}q&&(g[q]=l.target);break;case "characterData":var t=l.target.textContent;l.oldValue!=t&&(a.isBlocked(l.target)||(c[q]=t));break;case "attributes":var u=l.attributeName;l.target.hasAttribute(u)?(t=l.target.getAttribute(u),l.oldValue!=t&&(t=this.rewriteAttr(l.target,u,t),null!==t&&(b[q+":"+u]=t))):b[q+":"+u]=null}}catch(A){}for(var B in g)b=g[B],(c=a.mirrorFor(b))&&c.id&&this.diff(d,e,b,c.child,b.firstChild);
for(B in f)b=f[B],this.maybeAddPlaceholderResize(d,e,b)};c.prototype.diff=function(d,e,b,c,f){for(;c&&f;){var g=a.mirrorFor(f);a.fsid(f)?c.id==g.id?(c=c.next,f=f.nextSibling):(this.genRemove(d,e,c),c=c.next):(this.genInsert(d,e,b,f,c.node),f=f.nextSibling)}for(;c;c=c.next)this.genRemove(d,e,c);for(;f;f=f.nextSibling)this.genInsert(d,e,b,f,null)};c.prototype.maybeAddPlaceholderResize=function(d,e,b){try{for(;b&&!a.fsid(b);)b=b.parentNode;if(b&&a.isBlocked(b)){var c=b.getBoundingClientRect(),f=Math.floor(c.width),
g=Math.floor(c.height);e.push({When:d,Kind:a.EVENT_PLACEHOLDER_SIZE,Args:[a.fsid(b),f,g]})}}catch(p){}};c.prototype.genInsert=function(d,e,b,c,f){var g=this;if(b&&a.isBlocked(b))return null;c=this._encoder.tokenizeNode(b,f,c,function(a){g._visitor(d,a)});0<c.length&&e.push({When:d,Kind:a.EVENT_MUT_INSERT,Args:[a.fsid(b)||-1,a.fsid(f)||-1,this._lz.encode(c)]})};c.prototype.genRemove=function(d,e,b){var c=b.id;this._encoder.removeMirror(b);if(0<e.length&&(b=e[e.length-1],b.Kind==a.EVENT_MUT_REMOVE)){b.Args.push(c);
return}e.push({When:d,Kind:a.EVENT_MUT_REMOVE,Args:[c]})};c.prototype.rewriteAttr=function(d,e,b){switch(e){case "style":a.isBlocked(d)&&(b=this._blocker.mungeBlockedStyle(d,b));break;case "class":a.isBlocked(d)&&0>b.indexOf("_fs_block_")&&(d=a.blockKind(d),b+=" _fs_block_"+d);break;case "value":a.isBlocked(d)&&(b=null)}return b};return c}();a.MutationHandler=c})(g||(g={}));(function(a){var c=function(){function a(e,b,d){this._ctx=e;this._q=b;this._valueIndices=d;this._evts=[]}a.prototype.add=function(a){0==
this._evts.length&&this._q.push(a);this._evts.push(a)};a.prototype.finish=function(a,b){var d=this._evts.length;if(1>=d)return!1;for(var c=this._evts[0].When,f=this._evts[d-1].When,g=0;g<this._valueIndices.length;++g){var l=this._valueIndices[g],q=this._evts[0].Args[l],r=(this._evts[1].When-c)/(f-c),s=(this._evts[1].Args[l]-q)/r,t=this._evts[d-1].Args[l],r=(f-this._evts[d-2].When)/(f-c);b.push(q,t,s,(t-this._evts[d-2].Args[l])/r)}this._evts[0].Kind=a;this._evts[0].Args=b;return!0};a.prototype.evts=
function(){return this._evts};return a}(),f=function(){function d(a,b){this._ctx=a;this._blocker=b;this._gotInitialScroll=!1}d.prototype.processQueue=function(d){if(0==d.length)return d;this.maybeAddInitialScroll();for(var b=this._ctx.now(),f=[],g=new c(this._ctx,f,[0,1]),m={},p={},l,q=0;q<d.length;++q){var r=d[q];switch(r.Kind){case a.EVENT_MOUSEMOVE:g.add(r);break;case a.EVENT_TOUCHMOVE:var s=r.Args[0];s in m||(m[s]=new c(this._ctx,f,[1,2]));m[s].add(r);break;case a.EVENT_SCROLL:s=r.Args[0];s in
p||(p[s]=new c(this._ctx,f,[1,2]));p[s].add(r);break;case a.EVENT_INNERWIDTH:l||(l=new c(this._ctx,f,[0]));l.add(r);break;default:f.push(r)}}g.finish(a.EVENT_MOUSEMOVE_CURVE,[b])&&(d=g.evts(),g=d[d.length-1].Args,2<g.length&&g[2]&&d[0].Args.push(g[2]));for(s in p)d=parseInt(s),p[d].finish(a.EVENT_SCROLL_CURVE,[b,d]);for(s in m)d=parseInt(s),m[d].finish(a.EVENT_TOUCHMOVE_CURVE,[b,d]);l&&l.finish(a.EVENT_INNERWIDTH_CURVE,[b]);return f};d.prototype.maybeAddInitialScroll=function(){!this._gotInitialScroll&&
(document.body&&a.fsid(document.body))&&(this._ctx.addWindowScroll(),this._gotInitialScroll=!0)};return d}();a.EventProcessor=f})(g||(g={}));(function(a){var c=function(){function c(a){this._queue=a;this._overflow=this._enabled=!1;this._total=0}c.prototype.enable=function(){var a=this;a._enabled||(a._enabled=!0,window.console?(console.log&&console.log.apply&&(a._oldLog=console.log,console.log=function(){a.addLog("log",arguments);return a._oldLog.apply(this,arguments)}),console.info&&console.info.apply&&
(a._oldInfo=console.info,console.info=function(){a.addLog("info",arguments);return a._oldInfo.apply(this,arguments)}),console.warn&&console.warn.apply&&(a._oldWarn=console.warn,console.warn=function(){a.addLog("warn",arguments);return a._oldWarn.apply(this,arguments)}),console.error&&console.error.apply&&(a._oldError=console.error,console.error=function(){a.addLog("error",arguments);return a._oldError.apply(this,arguments)})):a.addLog("log",["NOTE: Log messages cannot be captured on IE9"]),a._oldOnError=
window.onerror,window.onerror=function(c,b,f){a.addError(c,b,f);if(a._oldOnError)return a._oldOnError.apply(this,arguments)})};c.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._oldLog&&(console.log=this._oldLog),this._oldInfo&&(console.info=this._oldInfo),this._oldWarn&&(console.warn=this._oldWarn),this._oldError&&(console.error=this._oldError),window.onerror=this._oldOnError)};c.prototype.addLog=function(c,e){if(this.checkOverflow()){for(var b=[c],f=0;f<e.length;++f){try{var g=
a.stringify(e[f])}catch(m){g=a.stringify(e[f].toString())}b.push(g)}this._queue.enqueue(a.EVENT_LOG,b)}};c.prototype.addError=function(c,e,b){this.checkOverflow()&&this._queue.enqueue(a.EVENT_ERROR,[c,e,b])};c.prototype.checkOverflow=function(){if(this._overflow)return!1;if(this._total==a.MAX_LOGS_PER_PAGE)return this._queue.enqueue(a.EVENT_LOG,["warn",c.OVERFLOW_MSG]),this._overflow=!0,!1;this._total++;return!0};c.OVERFLOW_MSG='"[received more than '+a.MAX_LOGS_PER_PAGE+' messages; no longer recording console]"';
return c}();a.ConsoleHook=c})(g||(g={}));(function(a){function c(a){J&&window.console&&console.log(a)}function f(a){F||(F=window.JSON);var b=Array.prototype.toJSON,c=String.prototype.toJSON;b&&delete Array.prototype.toJSON;c&&delete String.prototype.toJSON;a=F.stringify(a);b&&(Array.prototype.toJSON=b);c&&(String.prototype.toJSON=c);return a}function d(a){F||(F=window.JSON);return F.parse(a)}function e(){return(new Date).getTime()}function b(){return window!=top&&!$}function g(b,d,e,h){void 0===h&&
(h=null);b="//"+C+b;var k=null;null!=d&&(k=f(d),R+=k.length,c("total bytes written: "+R));var l=new XMLHttpRequest;if("withCredentials"in l)l.onreadystatechange=function(){l.readyState==a.XHR_DONE&&(200==l.status?e(l.responseText):h(l.status))},l.open("POST","https:"+b,!0),l.withCredentials=!0,l.setRequestHeader("Content-Type","text/plain"),l.send(k);else{var m=new XDomainRequest;m.onload=function(){e(m.responseText)};m.onerror=function(){h("Not Found"==m.responseText?404:500)};m.onprogress=function(){};
m.open("POST",b);m.send(k)}}function h(){if("baseURI"in document)return document.baseURI;var a=document.getElementsByTagName("base")[0];return a&&a.href?a.href:location.href}function m(a){(a=a.target.tagName)&&(a=a.toLowerCase());return a}function p(a,b){return a.tagName&&a.tagName.toLowerCase()in b?!0:a.parentNode?p(a.parentNode,b):!1}function l(a,b){if(void 0!==a.changedTouches)for(var c=0;c<a.changedTouches.length;++c){var d=a.changedTouches[c];isNaN(parseInt(d.identifier))&&(d.identifier=0);n.enqueue(b,
[d.identifier,d.clientX,d.clientY])}}function q(){var b=document.activeElement;if(b&&"value"in b){var c=a.fsidIfNotBlocked(b);c&&n.enqueue(a.EVENT_VALUECHANGE,[c,b.value])}}function r(){var b=window.innerWidth;b!=aa&&(n.enqueue(a.EVENT_INNERWIDTH,[b]),aa=b)}function s(a,b){a in S||(S[a]=setTimeout(function(){delete S[a];b()},ua))}function t(){var b=a.fsid(document.body);b&&s(b,function(){var c,d;"pageXOffset"in window?(c=window.pageXOffset,d=window.pageYOffset):(c=document.body.scrollLeft,d=document.body.scrollTop);
if(c!=ba||d!=ca)n.enqueue(a.EVENT_SCROLL,[b,c,d]),ba=c,ca=d;r()})}function u(b){var c=b.target,d=a.fsid(c);d&&s(d,function(){n.enqueue(a.EVENT_SCROLL,[d,c.scrollLeft,c.scrollTop])})}function A(){da?n.enqueue(a.EVENT_RESIZE,[document.body.clientWidth,document.body.clientHeight]):n.enqueue(a.EVENT_RESIZE,[document.documentElement.clientWidth,document.documentElement.clientHeight])}function B(){var b=location.href;T!=b&&(T=b,n.enqueue(a.EVENT_NAVIGATE,[location.href,document.title]))}function z(b){var c=
a.fsidIfNotBlocked(b);c&&n.enqueue(a.EVENT_VALUECHANGE,[c,a.valueOfInputishElem(b)])}function sa(){for(var a={},b=document.cookie.split(";"),c=0;c<b.length;c++){var d=b[c].replace(/^\s+|\s+$/g,"").split("=");a[d[0]]=d[1]}b={userId:"",appKey:"",poisoned:!1};if(c=a.fs_uid)c=c.split("`"),3>c.length?b.userId=a.fs_uid:c[0]==C&&c[1]==y&&(b.userId=c[2],5<=c.length&&(b.appKey=decodeURIComponent(c[3]),b.poisoned="true"==c[4]));return b}function O(a,b,c){a="fs_uid="+C+"`"+y+"`"+a;b&&(a+="`"+encodeURIComponent(b)+
"`"+c);document.cookie=a+"; domain=."+encodeURIComponent(ea)+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"}function Y(a){v=a.UserIntId;K=a.SessionIntId;U=a.PageIntId;ea=a.CookieDomain;fa=a.EmbedToken;ga=a.Eventstore;O(v,D,E);c("/User,"+v+"/Session,"+K+"/Page,"+U)}function P(a){if(L&&a){var b=document.createElement("script");b.text=a;b.async=!0;document.head.appendChild(b)}}function Q(){var a=document.doctype;if(!a)return null;var b;b="<!DOCTYPE "+a.name;a.publicId&&(b+=' PUBLIC "'+a.publicId+
'"');a.systemId&&(b+=' "'+a.systemId+'"');return b+">"}function ta(){var a=sa();v=a.userId;D=a.appKey;E=a.poisoned;v||(v="");var b=document.documentElement,e=window._fs_hash,a=window._fs_replay_flags;T=location.href;if(M)b={OrgId:y,UserId:v,Url:location.href,Base:h(),ScreenWidth:window.screen.width,ScreenHeight:window.screen.height,Width:b.clientWidth,Height:b.clientHeight,Referrer:document.referrer,Doctype:Q(),Hash:e},a&&(b.ReplayFlags=a),g("/rec/page",b,function(a){try{var b=d(a)}catch(e){Z();return}a=
b;Y(a);V=a.IntegrationScript;P(a.IntegrationScript);if(window._fs_ready)try{window._fs_ready()}catch(f){c("exception in _fs_ready(): "+f)}for(a=0;a<b.Blocks.length;++a)x.addRule(b.Blocks[a]);n.startPipeline()},function(a){Z()});else{c("Unable to record playback stream.");var f=document.createElement("script");window.__fs_startResponse=function(a){Y(a);V=a.IntegrationScript;P(a.IntegrationScript);document.body.removeChild(f)};f.src="//"+C+"/rec/page?OrgId="+y+"&UserId="+v+"&Url="+encodeURIComponent(location.href)+
"&Base="+encodeURIComponent(h())+"&ScreenWidth="+window.screen.width+"&ScreenHeight="+window.screen.height+"&Width="+b.clientWidth+"&Height="+b.clientHeight+"&Referrer="+encodeURIComponent(document.referrer)+"&Doctype="+encodeURIComponent(Q())+"&Fallback=true"+(a?"&ReplayFlags="+a:"")+(e?"&Hash="+e:"");document.body.appendChild(f)}}function Z(){n.disableRecording();ha();c("Disabling FS.");if(window._fs_ready)try{window._fs_ready(!0)}catch(a){c("exception in _fs_ready(): "+a)}}function va(){ia.hookMutations();
document.documentElement.addEventListener("scroll",function(a){u(a)},!0);window.addEventListener("mousemove",function(b){b=a.fsid(b.target)?[b.clientX,b.clientY,a.fsid(b.target)]:[b.clientX,b.clientY];n.enqueue(a.EVENT_MOUSEMOVE,b)},!0);window.addEventListener("mousedown",function(b){n.enqueue(a.EVENT_MOUSEDOWN,[b.clientX,b.clientY]);!p(b.target,{button:!0,a:!0,input:!0})||"input"==m(b)&&"submit"!=b.target.type||n.swanSong()},!0);window.addEventListener("mouseup",function(b){n.enqueue(a.EVENT_MOUSEUP,
[b.clientX,b.clientY])},!0);window.addEventListener("keydown",function(b){q();var c=document.activeElement;c&&!a.fsidIfNotBlocked(c)||n.enqueue(a.EVENT_KEYDOWN,[b.keyCode]);switch(m(b)){case "button":13!=b.keyCode&&32!=b.keyCode||n.swanSong();break;case "a":13==b.keyCode&&n.swanSong();break;case "input":"submit"==b.target.type&&13==b.keyCode&&n.swanSong()}},!0);window.addEventListener("keyup",function(b){q();var c=document.activeElement;c&&!a.fsidIfNotBlocked(c)||n.enqueue(a.EVENT_KEYUP,[b.keyCode])},
!0);window.addEventListener("scroll",function(a){t()});window.addEventListener("resize",function(a){A()});window.addEventListener("submit",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_FORM_SUBMIT,[b])});document.body.addEventListener("click",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_CLICK,[b])},!0);document.body.addEventListener("dblclick",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_DBL_CLICK,[b])},!0);document.body.addEventListener("focus",function(b){(b=a.fsid(b.target))&&
n.enqueue(a.EVENT_FOCUS,[b])},!0);document.body.addEventListener("blur",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_BLUR,[b])},!0);document.body.addEventListener("change",function(a){z(a.target)},!0);window.addEventListener("touchstart",function(b){l(b,a.EVENT_TOUCHSTART);t()},!0);window.addEventListener("touchend",function(b){l(b,a.EVENT_TOUCHEND);t()},!0);window.addEventListener("touchmove",function(b){l(b,a.EVENT_TOUCHMOVE);t()},!0);window.addEventListener("touchcancel",function(b){l(b,
a.EVENT_TOUCHCANCEL)},!0);window.addEventListener("play",function(b){var c=a.EVENT_PLAY;(b=a.fsid(b.target))&&n.enqueue(c,[b])},!0);window.addEventListener("pause",function(b){var c=a.EVENT_PAUSE;(b=a.fsid(b.target))&&n.enqueue(c,[b])},!0);W.hookEvents();if(history.pushState){window.addEventListener("popstate",function(){B()});var b=history.pushState;history.pushState=function(a,c,d){b.call(this,a,c,d);B()};var c=history.replaceState;history.replaceState=function(a,b,d){c.call(this,a,b,d);B()}}}function ja(){ka.enable()}
function wa(){var c=function(){L||(L=!0,n.enqueue(a.EVENT_DOMLOADED,[]),va(),A(),P(V))},d=!1,e=function(){d||(d=!0,n.enqueue(a.EVENT_LOAD,[]))};switch(document.readyState){case "interactive":document.attachEvent||c();break;case "complete":c(),e()}L||document.addEventListener("DOMContentLoaded",function(a){c()});d||window.addEventListener("load",function(a){c();e()});b()||(window.addEventListener("beforeunload",function(a){n.addUnload()}),window.addEventListener("unload",function(a){n.addUnload()}))}
function la(a,b){switch(a){case "account":if(E){c("blocking FS.identifyAccount API call due to mismatched user ID");break}ma("account",xa,b);break;case "user":if(b.uid){if(D&&D!=b.uid){c("blocking FS.identify API call; existing uid ("+D+") does not match provided uid ("+b.uid+")");E=!0;O(v,D,E);break}D=b.uid;E=!1;O(v,D,E)}else if(E){c("blocking FS.setUserVars API call due to mismatched user ID");break}ma("user",ya,b);break;default:c('invalid operation "'+a+'"; only "account" and "user" are supported at present')}}
function ma(b,d,e){var g={},h;for(h in e)if(e.hasOwnProperty(h)){var k=e[h];c("set-var('"+b+"'): \""+h+'" = '+f(k));var l,m;if(h in d)l=h,m=d[h];else{m=h.split("_");if(2!=m.length){c('variables must be of the form "name_type", where "type" is one of [str, bool, int, real, date]');continue}-1!=h.indexOf(" ")?(l=h.replace(/ /g,""),c("Warning: variable '"+h+"' has spaces in it, which is disallowed. Converted name to '"+l+"'.")):l=h;m=m[1]}m in na?na[m](k)?("date"==m&&(k=(k.constructor===Date?k:new Date(k)).toISOString()),
g[l]=k):c("illegal value "+f(k)+" for type "+m):c('invalid type "'+m+'"')}n.enqueue(a.EVENT_SYS_SETVAR,[b,f(g)])}function oa(){return v?v+":"+K:null}function za(){window.addEventListener("message",function(b){if("string"==typeof b.data&&0==b.data.indexOf(a.FS_MESSAGE_PREFIX)){var e=b.data.split(a.FS_DELIMITER);if(e[0]==a.FS_SET_FRAME_ID_CMD)try{var f=parseInt(e[1]),g=d(e[2]),h=parseInt(e[3]);var k=d(e[4]);if(f)if(w)c("frame Id is already set to "+w+". Received second request to set it to "+f+" Iframe:"+
location.href);else{c("FrameId received within frame "+location.href+": "+f);w=f;N=g;for(e=0;e<k.length;++e)x.addRule(k[e]);n.rebaseIframe(h,Q());H=h;n.startPipeline();if(0<I.length){for(e=0;e<I.length;e++)I[e]();I=[]}}else c("Outer page gave us a bogus frame Id! Iframe: "+location.href)}catch(l){c("Failed to parse frameId from message"+b.data)}else e[0]==a.FS_DISABLE_RECORDING?(n.disableRecording(),ha()):b.source==parent&&c("Invalid _fs postmessage command: "+e[0])}});w||(0==w?c("For some reason the outer window attempted to request a frameId"):
(c("Asking for a frame ID from within frame: "+location.href),parent.postMessage(a.FS_REQUEST_FRAME_ID+a.FS_DELIMITER,"*")))}function ha(){for(var b=0;b<G.length;b++){var c=G[b];c.contentWindow&&c.contentWindow.postMessage&&c.contentWindow.postMessage(a.FS_DISABLE_RECORDING,"*")}}function Aa(){window.addEventListener("message",function(e){if("string"==typeof e.data&&0==e.data.indexOf(a.FS_MESSAGE_PREFIX)){var f=e.data.split(a.FS_DELIMITER);if(f[0]==a.FS_IFRAME_EVENTS)e=d(f[1]),0<e.length&&(b()?n.appendToQueue(e):
n.appendToOutgoingQueue(e));else{var g;a:{g=e.source;for(var h=0;h<G.length;h++)if(G[h].contentWindow==g){g=a.fsid(G[h]);break a}c("Unable to locate frame for window");g=NaN}f[0]==a.FS_REQUEST_FRAME_ID?e.source&&g?(c("Responding to FID request for frame "+g),pa(e.source,g)):c("No FrameId found. Hoping to send one later."):b()||c("Invalid _fs postmessage command: "+f[0]+" sent from child FrameId: "+g)}}})}function pa(b,c){var d=function(){var d=f(x.rawRules),e=[];0!=w&&(e=N?N.concat(w):[w]);b.postMessage(a.FS_SET_FRAME_ID_CMD+
a.FS_DELIMITER+c+a.FS_DELIMITER+f(e)+a.FS_DELIMITER+H+a.FS_DELIMITER+d,"*")};null==w?I.push(d):d()}function qa(a){c("Injecting into Frame ["+a.src+"]");try{if(a.src&&("about:blank"!=a.src&&0>a.src.indexOf("javascript:"))&&a.src!=a.contentWindow.location.href)c("Frame not yet loaded: "+a.src);else if(a.contentWindow.FS)c("FS already defined in Frame contentWindow: "+a.src+". Ignoring.");else{var b=a.contentDocument;a="var _fs_org='"+y+"', _fs_host='"+C+"', _fs_run_in_iframe=true, _fs_debug="+J+"; (function(w,a,t){a=w.createElement('script');a.async=1;a.src='https://'+_fs_host+'/s/fs.js';w.head.appendChild(a)})(document);";
var d=b.createElement("script");d.textContent=a;b.head.appendChild(d)}}catch(e){c("iFrame no injecty. Probably not same origin.")}}function Ba(a,b){G.push(b);Ca(b)?(c("Attempting to setup Frame ["+b.src+"]"),qa(b),b.addEventListener("load",function(a){c("onload for frame ["+b.src+"]");qa(b)})):(c("Frame Doesn't need injecting. Probably cross domain ["+b.src+"]"),b.contentWindow.postMessage&&(c("Eagerly sending FrameId "+a+" to Frame ["+b.src+"]"),pa(b.contentWindow,a)))}function Ca(a){var b=a.src;
return!a.hasAttribute("src")||"about:blank"==b||0==b.indexOf("javascript:")||0==b.indexOf(Da)}var ua=a.MUTATION_PROCESSING_INTERVAL/5,J=!1,R=0,y,v,K,U,D,E,ga,w,N,C,ea,Da=window.location.protocol+"//"+window.location.host,$,M,H=e(),T,L=!1,V=null,ra,ba=-1,ca=-1,aa=0,S={},fa,F,da=!1,X={startTime:function(){return H},now:function(){return e()-H},wallTime:e,orgId:function(){return y},userId:function(){return v},sessionId:function(){return K},pageId:function(){return U},eventstore:function(){return ga},
baseUri:h,amInsideIFrame:b,frameId:function(){return w},parentIds:function(){return N},post:g,addWindowScroll:t},x=new a.Blocker,W=new a.InputWatcher(function(a){z(a)},function(b){return!!a.fsid(b)}),ia=new a.MutationHandler(X,x,function(b,d){switch(d.nodeName){case "INPUT":case "TEXTAREA":case "SELECT":W.addInput(d);break;case "FRAME":case "IFRAME":var e=a.fsid(d);if(!e){c("fsid missing or invalid for iFrame."+d.src);break}ra||(Aa(),ra=!0);Ba(e,d);break;case "VIDEO":case "AUDIO":d.paused||(e=a.fsid(d),
n.enqueue(a.EVENT_PLAY,[e]))}}),Ea=new a.EventProcessor(X,x),n=new a.EventQueue(X,Ea,ia,function(){W.tick();r()}),ka=new a.ConsoleHook(n);window._fs_shutdown=function(a){n.shutdown();a&&(a=document.getElementById(a))&&a.setAttribute("_fs_embed_token",fa)};a.log=c;a.stringify=f;a.parseJson=d;a.enableConsole=ja;a.disableConsole=function(){ka.disable()};a._init=function(){if("_fs_host"in window||"_fs_ext_host"in window)if("_fs_org"in window||"_fs_ext_org"in window)if("_fs_ext_debug"in window?J=!!window._fs_ext_debug:
"_fs_debug"in window&&(J=!!window._fs_debug),C=window._fs_ext_host||window._fs_host,y=window._fs_ext_org||window._fs_org,c("host: "+C),c("orgid: "+y),da="BackCompat"==document.compatMode,$=!!window._fs_is_outer_script,w=b()?null:0,M=!!window.MutationEvent,b())window._fs_run_in_iframe?parent.postMessage?za():(M=!1,c("postMessage not supported")):c("Fullstory recording for this page is NOT allowed within an iFrame.");else{x.addRule({Selector:"object",Kind:a.NYI_KIND});x.addRule({Selector:"embed",Kind:a.NYI_KIND});
x.addRule({Selector:"canvas",Kind:a.NYI_KIND});x.addRule({Selector:"noscript",Kind:a.BLOCKED_KIND});x.addRule({Selector:".fs-hide",Kind:a.HIDE_KIND});var d=window.FS.q;if(d){for(var e=0;e<d.length;e++)la(d[e][0],d[e][1]);delete window.FS.q}ta()}else c("Missing global _fs_org. Recording disabled.");else c("Missing global _fs_host. Recording disabled.")};a._record=function(){M&&(n.recoverSwanSong(),H=e(),wa(),ja())};var xa={acctId:"str",displayName:"str",website:"str"},ya={uid:"str",displayName:"str",
email:"str"},na={str:function(a){return"string"==typeof a},bool:function(a){return"boolean"==typeof a},"int":function(a){return"number"==typeof a&&0==a-Math.floor(a)},real:function(a){return"number"==typeof a},date:function(a){return!isNaN(a.constructor===Date?a:new Date(a))}};a._api=la;a.setUid=function(b,d,e){b&&"string"==typeof b?d&&"string"!=typeof d?c("setUid(): second argument (display name) must be a string"):(d||(d=b),e&&"object"!=typeof e?c('setUid(): third argument (metadata) must be of the form {name0: "value0", name1: "value1", ...}'):
(e=e?f(e):"",c("setting uid: "+b+", meta: "+e),n.enqueue(a.EVENT_SYS_SETMETA,[b,d,e]))):c("setUid(): first argument (user id) is required and must be a string")};a.getCurrentSessionURL=function(){var a=oa();return a?"https://"+C+"/ui/"+y+"/session/"+a:null};a.getCurrentSession=oa;a.FS_MESSAGE_PREFIX="_fs";a.FS_DELIMITER="\u2603";a.FS_REQUEST_FRAME_ID=a.FS_MESSAGE_PREFIX+"RequestFrameId";a.FS_SET_FRAME_ID_CMD=a.FS_MESSAGE_PREFIX+"SetFrameId";a.FS_IFRAME_EVENTS=a.FS_MESSAGE_PREFIX+"EvtBundle";a.FS_DISABLE_RECORDING=
a.FS_MESSAGE_PREFIX+"DisableRecording";var G=[],I=[]})(g||(g={}));try{"FS"in window||(window.FS={}),"_loaded"in window.FS||(window.FS._loaded=!0,window.FS.setUid=g.setUid,window.FS.getCurrentSessionURL=g.getCurrentSessionURL,window.FS.getCurrentSession=g.getCurrentSession,window.FS.enableConsole=g.enableConsole,window.FS.disableConsole=g.disableConsole,window.FS.log=g.log,window.FS._api=g._api,g._init(),g._record())}catch(z){window.console&&console.log&&console.log("Failed to initialize FullStory.")}})();
//# sourceMappingURL=/s/fs.map